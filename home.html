<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml">
	<head>
		<script src="javascript/jquery.min.js"></script>
		<meta charset="utf-8" />
		<title>Surprise!</title>
		<link href="css/bootstrap-combined.min.css" rel="stylesheet">
		<script src="javascript/bootstrap.min.js"></script>
		<style type="text/css">
			#any {
				position: absolute;
				left: 250px;
				top: 150px;
				background-image: url(images/nm4.png);
				width: 100px;
				height: 100px;
			}
			#welcome {
				position: absolute;
				left: 0px;
				top: 0px;
				font-size: 20px;
			}
			.container {
				position: relative;
				width: 600px;
				height: 300px;
			}
		</style>
	</head>
	<body>
		<center>
			<div class="container">
				<div id="any"></div>
				<div id="welcome"></div>
			</div>
			<table>
				<tr>
					<td>
						<div id="fb_login" class="btn btn-primary"></div>	
					</td>
					<td>
						<div id="guest_login" class="btn"></div>
					</td>
				</tr>
				<tr>
					<td colspan="2" align="center"><br>
						<select id="lang_select">
							<option value="en">English</option>
							<option value="zh">繁體中文</option>
							<option value="ja">日本語</option>
						</select>
					</td>
				</tr>
			</table>
		</center>
		<script type="text/javascript">
			var lang = "en";
			var translation = {
				"welcome": {
					"en": "Welcome, my lord.",
					"zh": "主人您來啦？歡迎～",
					"ja": "いらっしゃいませ、御主人様。"
				},
				"fb_login": {
					"en": "Use facebook account",
					"zh": "Facebook登入",
					"ja": "Facebookでログイン"
				},
				"guest_login": {
					"en": "Login as guest",
					"zh": "訪客帳號",
					"ja": "訪問者登録"
				},
				"login_plz": {
					"en": "Login your account, and agree to use app.",
					"zh": "請登入並同意使用本應用程式",
					"ja": "ログインください"
				}
			};

			var any_left = parseInt($("#any").css("left"), 10);
			var any_top = parseInt($("#any").css("top"), 10);

			$("#lang_select").change(function() {
				lang = $("#lang_select").prop("value");
				localize();
			});

			localize();
			function localize() {
			
				$("#welcome").html(translation["welcome"][lang]);
				$("#welcome").css("left", any_left + 80 + "px");
				$("#welcome").css("top", any_top - 20 + "px");

				$("#guest_login").html(translation["guest_login"][lang]);
				$("#fb_login").html(translation["fb_login"][lang]);
			}
		</script>
		<div id="fb-root"></div>
		<script src="/socket.io/socket.io.js"></script>
		<script type="text/javascript">
		var hostname = "mr-tvbs.nko3.jitsu.com"; //localhost:7331
		window.fbAsyncInit = function() {
			FB.init({
				appId      : '296602400450029',
				channelUrl : '//'+hostname+"/channel.html",
				status     : true,
				cookie     : true,
				xfbml      : true
			});
			$("#fb_login").click(function() {
				FB.login(function(response) {
					if (response.authResponse) {
						FB.api('/me', function(response) {
							console.log(response.username);
							location.href = "client.html";
						});
					}
					else {
						alert(translation["login_plz"][lang]);
					}
				}, {scope: 'user_about_me, publish_stream'});
			});
			$("#guest_login").click(function() {
				location.href = "client.html";
			});
  		};
		(function(d, debug){
			var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
			if (d.getElementById(id)) {return;}
			js = d.createElement('script'); js.id = id; js.async = true;
			js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
			ref.parentNode.insertBefore(js, ref);
		}(document,  false));
		</script>
	</body>
</html>